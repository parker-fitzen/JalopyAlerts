<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jalopy Alerts — Multi‑Yard Inventory Search & Alerts</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Jalopy Alerts — Multi‑Yard Inventory Search & Alerts</h1>
      <p>Search across multiple Tresure Valley self-service jalopy yards and filter by year range.</p>
      <p>Set up alerts for new arrivals.</p>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <div class="grid controls">
        <div class="col-4">
          <label for="make">Make</label>
          <select id="make" disabled>
            <option value="">Loading makes…</option>
          </select>
        </div>

        <div class="col-4">
          <label for="model">Model</label>
          <select id="model" disabled>
            <option value="">Select a make first</option>
          </select>
        </div>

        <div class="col-2">
          <label for="minYear">Min year</label>
          <input id="minYear" type="number" inputmode="numeric" placeholder="e.g. 2005" />
        </div>

        <div class="col-2">
          <label for="maxYear">Max year</label>
          <input id="maxYear" type="number" inputmode="numeric" placeholder="e.g. 2015" />
        </div>

        <div class="col-12 row">
          <button id="searchBtn" disabled>Search all yards</button>
          <button id="resetBtn" class="secondary">Reset</button>
          <span id="status" class="status"></span>
        </div>

        <div class="col-12">
          <div id="yardCounts" class="pillbar"></div>
        </div>

        <div class="col-12 row">
          <div style="min-width: 220px; flex: 1;">
            <label for="quickFilter">Quick filter (contains)</label>
            <input id="quickFilter" placeholder="type to filter displayed rows…" />
          </div>
          <div style="min-width: 220px;">
            <label for="sort">Sort</label>
            <select id="sort">
              <option value="year_desc">Year (newest first)</option>
              <option value="year_asc">Year (oldest first)</option>
              <option value="yard_asc">Yard (A→Z)</option>
              <option value="yard_desc">Yard (Z→A)</option>
            </select>
          </div>
        </div>
      </div>

      <div style="margin-top: 12px; max-height: 56vh; overflow: auto; border-radius: 12px; border: 1px solid #eee;">
        <table>
          <thead>
            <tr>
              <th style="min-width: 75px;">YARD</th>
              <th style="min-width: 40px;">YEAR</th>
              <th style="min-width: 100px;">MAKE</th>
              <th style="min-width: 120px;">MODEL</th>
              <th style="min-width: 40px;">ROW</th>
            </tr>
          </thead>
          <tbody id="results">
            <tr><td class="muted" colspan="5">Load makes, select a make/model, then search.</td></tr>
          </tbody>
        </table>
      </div>

      <div class="footer-note">
        Note: This fans out requests (one per yard). Keep usage reasonable so you don’t get your proxy or the upstream site blocked.
      </div>
    </div>

    <div class="card" id="alertsCard">
      <div class="row" style="justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap;">
        <div>
          <h2 style="margin: 0;">Saved alerts</h2>
          <p class="muted" style="margin: 4px 0 0;">Save this search and get notified when new vehicles arrive.</p>
        </div>
        <button id="refreshAlertsBtn" class="secondary">Refresh saved alerts</button>
      </div>

      <div class="grid controls" style="margin-top: 12px;">
        <div class="col-4">
          <label for="alertMinYear">Alert min year (optional)</label>
          <input id="alertMinYear" type="number" placeholder="Use a range or leave blank for all years" />
        </div>
        <div class="col-4">
          <label for="alertMaxYear">Alert max year (optional)</label>
          <input id="alertMaxYear" type="number" placeholder="Use a range or leave blank for all years" />
        </div>
        <div class="col-4">
          <label for="alertNotes">What will be saved?</label>
          <div id="alertNotes" class="muted" style="padding: 12px; border: 1px dashed var(--border); border-radius: 10px; background: #fffaf5;">
            Pick a make/model above, then save the alert.
          </div>
        </div>
        <div class="col-12">
          <div class="muted-border" id="pushStatus">Push notifications are not enabled yet. Click below and allow notifications in your browser.</div>
        </div>
        <div class="col-12 row">
          <button id="enablePushBtn" class="secondary">Enable browser notifications</button>
          <button id="saveAlertBtn">Save alert for this search</button>
          <span id="alertStatus" class="status"></span>
        </div>
      </div>

      <div id="alertsList" class="alerts-list" aria-live="polite"></div>
    </div>
  </main>

  <script src="scripts/app.js"></script>
</body>
</html>
